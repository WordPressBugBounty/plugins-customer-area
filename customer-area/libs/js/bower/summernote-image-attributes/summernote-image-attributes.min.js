(function(factory){if(typeof define === 'function' && define.amd) {define(['jquery'], factory);} else if (typeof module === 'object' && module.exports) {module.exports = factory(require('jquery'));} else {factory(window.jQuery);}}(function ($) {'use strict';!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(window.jQuery)}(function(w){w.extend(!0,w.summernote.lang,{"en-US":{imageAttributes:{dialogTitle:"Image Attributes",tooltip:"Image Attributes",tabImage:"Image",src:"Source",browse:"Browse",title:"Title",alt:"Alt Text",dimensions:"Dimensions",tabAttributes:"Attributes",class:"Class",style:"Style",role:"Role",tabLink:"Link",linkHref:"URL",linkTarget:"Target",linkTargetInfo:"Options: _self, _blank, _top, _parent",linkClass:"Class",linkStyle:"Style",linkRel:"Rel",linkRelInfo:"Options: alternate, author, bookmark, help, license, next, nofollow, noreferrer, prefetch, prev, search, tag",linkRole:"Role",tabUpload:"Upload",upload:"Upload",tabBrowse:"Browse",editBtn:"OK"}}}),w.extend(w.summernote.options,{imageAttributes:{icon:'<i class="note-icon-pencil"/>',removeEmpty:!0,disableUpload:!1,imageFolder:""}}),w.extend(w.summernote.plugins,{imageAttributes:function(A){var t,h=this,k=w.summernote.ui,i=A.layoutInfo.note,l=A.layoutInfo.editor,y=A.layoutInfo.editable,x=A.options,a=x.langInfo,n="";x.maximumImageFileSize&&(t=Math.floor(Math.log(x.maximumImageFileSize)/Math.log(1024)),t=+(x.maximumImageFileSize/Math.pow(1024,t)).toFixed(2)+" "+" KMGTP"[t]+"B",n='<small class="help-block note-help-block">'+a.image.maximumFileSize+" : "+t+"</small>"),"_counter"in w.summernote.options.imageAttributes||(w.summernote.options.imageAttributes._counter=0),A.memo("button.imageAttributes",function(){return k.button({contents:x.imageAttributes.icon,container:"body",tooltip:a.imageAttributes.tooltip,click:function(){A.invoke("imageAttributes.show")}}).render()}),this.initialize=function(){var t=x.dialogsInBody?w(document.body):l,e=(w.summernote.options.imageAttributes._counter++,w.summernote.options.imageAttributes._counter),o='<ul class="nav note-nav nav-tabs note-nav-tabs"><li class="nav-item note-nav-item active"><a class="nav-link note-nav-link active" href="#note-imageAttributes-'+e+'" data-toggle="tab">'+a.imageAttributes.tabImage+'</a></li><li class="nav-item note-nav-item"><a class="nav-link note-nav-link" href="#note-imageAttributes-attributes-'+e+'" data-toggle="tab">'+a.imageAttributes.tabAttributes+'</a></li><li class="nav-item note-nav-item"><a class="nav-link note-nav-link" href="#note-imageAttributes-link-'+e+'" data-toggle="tab">'+a.imageAttributes.tabLink+"</a></li>";0==x.imageAttributes.disableUpload&&(o+='<li class="nav-item note-nav-item"><a class="nav-link note-nav-link" href="#note-imageAttributes-upload-'+e+'" data-toggle="tab">'+a.imageAttributes.tabUpload+"</a></li>"),o+='</ul><div class="tab-content"><div class="tab-pane note-tab-pane" id="note-imageAttributes-attributes-'+e+'"><div class="note-form-group form-group note-group-imageAttributes-class"><label class="control-label note-form-label col-sm-3">'+a.imageAttributes.class+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-class form-control note-form-control note-input" type="text"></div></div><div class="note-form-group form-group note-group-imageAttributes-style"><label class="control-label note-form-label col-sm-3">'+a.imageAttributes.style+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-style form-control note-form-control note-input" type="text"></div></div><div class="note-form-group form-group note-group-imageAttributes-role"><label class="control-label note-form-label col-sm-3">'+a.imageAttributes.role+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-role form-control note-form-control note-input" type="text"></div></div></div><div class="tab-pane note-tab-pane" id="note-imageAttributes-link-'+e+'"><div class="note-form-group form-group note-group-imageAttributes-link-href"><label class="control-label note-form-label col-xs-3">'+a.imageAttributes.linkHref+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-link-href form-control note-form-control note-input" type="text"></div></div><div class="note-form-group form-group note-group-imageAttributes-link-target"><label class="control-label note-form-label col-xs-3">'+a.imageAttributes.linkTarget+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-link-target form-control note-form-control note-input" type="text"></div><small class="help-block note-help-block text-right">'+a.imageAttributes.linkTargetInfo+'</small></div><div class="note-form-group form-group note-group-imageAttributes-link-class"><label class="control-label note-form-label col-xs-3">'+a.imageAttributes.linkClass+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-link-class form-control note-form-control note-input" type="text"></div></div><div class="note-form-group form-group note-group-imageAttributes-link-style"><label class="control-label note-form-label col-xs-3">'+a.imageAttributes.linkStyle+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-link-style form-control note-form-control note-input" type="text"></div></div><div class="note-form-group form-group note-group-imageAttributes-link-rel"><label class="control-label note-form-label col-xs-3">'+a.imageAttributes.linkRel+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-link-rel form-control note-form-control note-input" type="text"></div><small class="help-block note-help-block text-right">'+a.imageAttributes.linkRelInfo+'</small></div><div class="note-form-group form-group note-group-imageAttributes-link-role"><label class="control-label note-form-label col-xs-3">'+a.imageAttributes.linkRole+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-link-role form-control note-form-control note-input" type="text"></div></div></div>',0==x.imageAttributes.disableUpload&&(o+='<div class="tab-pane note-tab-pane" id="note-imageAttributes-upload-'+e+'"><label class="control-label note-form-label col-xs-3">'+a.imageAttributes.upload+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-input form-control note-form-control note-input" type="file" name="files" accept="image/*" multiple="multiple">'+n+"</div></div>"),o+='<div class="tab-pane note-tab-pane fade in active" id="note-imageAttributes-'+e+'"><div class="note-form-group form-group note-group-imageAttributes-url"><label class="control-label note-form-label col-sm-3">'+a.imageAttributes.src+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-src form-control note-form-control note-input" type="text"></div></div><div class="note-form-group form-group note-group-imageAttributes-title"><label class="control-label note-form-label col-sm-3">'+a.imageAttributes.title+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-title form-control note-form-control note-input" type="text"></div></div><div class="note-form-group form-group note-group-imageAttributes-alt"><label class="control-label note-form-label col-sm-3">'+a.imageAttributes.alt+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-alt form-control note-form-control note-input" type="text"></div></div><div class="note-form-group form-group note-group-imageAttributes-dimensions"><label class="control-label note-form-label col-sm-3">'+a.imageAttributes.dimensions+'</label><div class="input-group note-input-group col-xs-12 col-sm-9"><input class="note-imageAttributes-width form-control note-form-control note-input" type="text"><span class="input-group-addon note-input-group-addon">x</span><input class="note-imageAttributes-height form-control note-form-control note-input" type="text"></div></div></div></div>',this.$dialog=k.dialog({title:a.imageAttributes.dialogTitle,body:o,footer:'<button href="#" class="btn btn-primary note-btn note-btn-primary note-imageAttributes-btn">'+a.imageAttributes.editBtn+"</button>"}).render().appendTo(t)},this.destroy=function(){k.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(t,e){t.on("keypress",function(t){13===t.keyCode&&e.trigger("click")})},this.bindLabels=function(){h.$dialog.find(".form-control:first").focus().select(),h.$dialog.find("label").on("click",function(){w(this).parent().find(".form-control:first").focus()})},this.show=function(){var t=w(y.data("target")),t={imgDom:t,title:t.attr("title"),src:t.attr("src"),alt:t.attr("alt"),width:t.attr("width"),height:t.attr("height"),role:t.attr("role"),class:t.attr("class"),style:t.attr("style"),imgLink:w(t).parent().is("a")?w(t).parent():null};this.showImageAttributesDialog(t).then(function(t){k.hideDialog(h.$dialog);var e,o=t.imgDom;x.imageAttributes.removeEmpty?(t.alt?o.attr("alt",t.alt):o.removeAttr("alt"),t.width?o.attr("width",t.width):o.removeAttr("width"),t.height?o.attr("height",t.height):o.removeAttr("height"),t.title?o.attr("title",t.title):o.removeAttr("title"),t.src?o.attr("src",t.src):o.attr("src","#"),t.class?o.attr("class",t.class):o.removeAttr("class"),t.style?o.attr("style",t.style):o.removeAttr("style"),t.role?o.attr("role",t.role):o.removeAttr("role")):(t.src?o.attr("src",t.src):o.attr("src","#"),o.attr("alt",t.alt),o.attr("width",t.width),o.attr("height",t.height),o.attr("title",t.title),o.attr("class",t.class),o.attr("style",t.style),o.attr("role",t.role)),o.parent().is("a")&&o.unwrap(),t.linkHref&&(e="<a",t.linkClass&&(e+=' class="'+t.linkClass+'"'),t.linkStyle&&(e+=' style="'+t.linkStyle+'"'),e+=' href="'+t.linkHref+'" target="'+t.linkTarget+'"',t.linkRel&&(e+=' rel="'+t.linkRel+'"'),t.linkRole&&(e+=' role="'+t.linkRole+'"'),o.wrap(e+="></a>")),i.val(A.invoke("code")),i.change()})},this.showImageAttributesDialog=function(v){return w.Deferred(function(e){var o=h.$dialog.find(".note-imageAttributes-title"),t=h.$dialog.find(".note-imageAttributes-input"),i=h.$dialog.find(".note-imageAttributes-src"),l=h.$dialog.find(".note-imageAttributes-alt"),a=h.$dialog.find(".note-imageAttributes-width"),n=h.$dialog.find(".note-imageAttributes-height"),r=h.$dialog.find(".note-imageAttributes-class"),s=h.$dialog.find(".note-imageAttributes-style"),u=h.$dialog.find(".note-imageAttributes-role"),m=h.$dialog.find(".note-imageAttributes-link-href"),g=h.$dialog.find(".note-imageAttributes-link-target"),c=h.$dialog.find(".note-imageAttributes-link-class"),p=h.$dialog.find(".note-imageAttributes-link-style"),b=h.$dialog.find(".note-imageAttributes-link-rel"),d=h.$dialog.find(".note-imageAttributes-link-role"),f=h.$dialog.find(".note-imageAttributes-btn");m.val(),c.val(),p.val(),d.val(),g.val(),b.val(),v.imgLink&&(m.val(v.imgLink.attr("href")),c.val(v.imgLink.attr("class")),p.val(v.imgLink.attr("style")),d.val(v.imgLink.attr("role")),g.val(v.imgLink.attr("target")),b.val(v.imgLink.attr("rel"))),k.onDialogShown(h.$dialog,function(){A.triggerEvent("dialog.shown"),t.replaceWith(t.clone().on("change",function(){var t;x.callbacks.onImageUpload?A.triggerEvent("image.upload",this.files[0]):(t=this.files[0],w.Deferred(function(e){w.extend(new FileReader,{onload:function(t){t=t.target.result;e.resolve(t)},onerror:function(){e.reject(this)}}).readAsDataURL(t)}).promise().then(function(t){i.val(t)}).fail(function(){A.triggerEvent("image.upload.error")}))}).val("")),f.click(function(t){t.preventDefault(),e.resolve({imgDom:v.imgDom,title:o.val(),src:i.val(),alt:l.val(),width:a.val(),height:n.val(),class:r.val(),style:s.val(),role:u.val(),linkHref:m.val(),linkTarget:g.val(),linkClass:c.val(),linkStyle:p.val(),linkRel:b.val(),linkRole:d.val()}).then(function(t){A.triggerEvent("change",y.html())})}),o.val(v.title),i.val(v.src),l.val(v.alt),a.val(v.width),n.val(v.height),r.val(v.class),s.val(v.style),u.val(v.role),h.bindEnterKey(f),h.bindLabels()}),k.onDialogHidden(h.$dialog,function(){f.off("click"),"pending"===e.state()&&e.reject()}),k.showDialog(h.$dialog)})}}})});}));